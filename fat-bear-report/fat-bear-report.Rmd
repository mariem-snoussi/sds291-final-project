---
title: "SDS 291 - Fat Bear 2020-2021"
author: "Laura Mora, Mariem Snoussi, Maya Crandall-Malcolm"
date: "`r Sys.Date()`"
output: 
  pdf_document: 
    toc: true
---

```{r load-packages, message=FALSE}
library(tidyverse)
library(openintro)
library(mosaic)
library(modeest)
library(GGally)
```


```{r}
bears<-read.csv("FullBearData.csv")
survey20<-read.csv("Survey2020.csv")
survey21<-read.csv("Survey2021.csv")
```

```{r, include=FALSE, eval=FALSE}
# 2020 Bear 909 results
nineonine<-filter(survey20, BearNumber=="909")
mlv(nineonine$FurColor, method="mfv")
mlv(nineonine$SizeBefore, method="mfv")
mlv(nineonine$SizeAfter, method="mfv")
mean(nineonine$Angle)

# 2020 Bear 856 results
b856<-filter(survey20, BearNumber=="856")
mlv(b856$FurColor, method="mfv")
mlv(b856$SizeBefore, method="mfv")
mlv(b856$SizeAfter, method="mfv")
mean(b856$Angle)

#2020 bear 812
b812<-filter(survey20, BearNumber=="812")
mlv(b812$FurColor, method="mfv")
mlv(b812$SizeBefore, method="mfv")
mlv(b812$SizeAfter, method="mfv")
mean(b812$Angle)

# 2020 bear 747
b747<-filter(survey20, BearNumber=="747")
mlv(b747$FurColor, method="mfv")
mlv(b747$SizeBefore, method="mfv")
mlv(b747$SizeAfter, method="mfv")
mean(b747$Angle)

# 2020 bear 719
b719<-filter(survey20, BearNumber=="719")
mlv(b719$FurColor, method="mfv")
mlv(b719$SizeBefore, method="mfv")
mlv(b719$SizeAfter, method="mfv")
mean(b719$Angle)

# 2020 bear 480
b480<-filter(survey20, BearNumber=="480")
mlv(b480$FurColor, method="mfv")
mlv(b480$SizeBefore, method="mfv")
mlv(b480$SizeAfter, method="mfv")
mean(b480$Angle)

# 2020 bear 435
b435<-filter(survey20, BearNumber=="435")
mlv(b435$FurColor, method="mfv")
mlv(b435$SizeBefore, method="mfv")
mlv(b435$SizeAfter, method="mfv")
mean(b435$Angle)

# 2020 bear 402
b402<-filter(survey20, BearNumber=="402")
mlv(b402$FurColor, method="mfv")
mlv(b402$SizeBefore, method="mfv")
mlv(b402$SizeAfter, method="mfv")
mean(b402$Angle)

# 2020 bear 151
b151<-filter(survey20, BearNumber=="151")
mlv(b151$FurColor, method="mfv")
mlv(b151$SizeBefore, method="mfv")
mlv(b151$SizeAfter, method="mfv")
mean(b151$Angle)

# 2020 bear 128
b128<-filter(survey20, BearNumber=="128")
mlv(b128$FurColor, method="mfv")
mlv(b128$SizeBefore, method="mfv")
mlv(b128$SizeAfter, method="mfv")
mean(b128$Angle)

# 2020 bear 32
b32<-filter(survey20, BearNumber=="32")
mlv(b32$FurColor, method="mfv")
mlv(b32$SizeBefore, method="mfv")
mlv(b32$SizeAfter, method="mfv")
mean(b32$Angle)
```

```{r, include=FALSE, eval=FALSE}
### 2021 survey results
# 812
b812<-filter(survey21, BearNumber=="812")
mlv(b812$FurColor, method="mfv")
mlv(b812$SizeBefore, method="mfv")
mlv(b812$SizeAfter, method="mfv")
mean(b812$Angle)

# 747
b747<-filter(survey21, BearNumber=="747")
mlv(b747$FurColor, method="mfv")
mlv(b747$SizeBefore, method="mfv")
mlv(b747$SizeAfter, method="mfv")
mean(b747$Angle)

# 634
b634<-filter(survey21, BearNumber=="634")
mlv(b634$FurColor, method="mfv")
mlv(b634$SizeBefore, method="mfv")
mlv(b634$SizeAfter, method="mfv")
mean(b634$Angle)

# 503
b503<-filter(survey21, BearNumber=="503")
mlv(b503$FurColor, method="mfv")
mlv(b503$SizeBefore, method="mfv")
mlv(b503$SizeAfter, method="mfv")
mean(b503$Angle)

# 480
b480<-filter(survey21, BearNumber=="480")
mlv(b480$FurColor, method="mfv")
mlv(b480$SizeBefore, method="mfv")
mlv(b480$SizeAfter, method="mfv")
mean(b480$Angle)

# 435 
b435<-filter(survey21, BearNumber=="435")
mlv(b435$FurColor, method="mfv")
mlv(b435$SizeBefore, method="mfv")
mlv(b435$SizeAfter, method="mfv")
mean(b435$Angle)

# 402
b402<-filter(survey21, BearNumber=="402")
mlv(b402$FurColor, method="mfv")
mlv(b402$SizeBefore, method="mfv")
mlv(b402$SizeAfter, method="mfv")
mean(b402$Angle)

# 151
b151<-filter(survey21, BearNumber=="151")
mlv(b151$FurColor, method="mfv")
mlv(b151$SizeBefore, method="mfv")
mlv(b151$SizeAfter, method="mfv")
mean(b151$Angle)

# 132
b132<-filter(survey21, BearNumber=="132")
mlv(b132$FurColor, method="mfv")
mlv(b132$SizeBefore, method="mfv")
mlv(b132$SizeAfter, method="mfv")
mean(b132$Angle)

# 131
b131<-filter(survey21, BearNumber=="131")
mlv(b131$FurColor, method="mfv")
mlv(b131$SizeBefore, method="mfv")
mlv(b131$SizeAfter, method="mfv")
mean(b131$Angle)

# 32
b32<-filter(survey21, BearNumber=="32")
mlv(b32$FurColor, method="mfv")
mlv(b32$SizeBefore, method="mfv")
mlv(b32$SizeAfter, method="mfv")
mean(b32$Angle)

# 128
b128<-filter(survey21, BearNumber=="128")
mlv(b128$FurColor, method="mfv")
mlv(b128$SizeBefore, method="mfv")
mlv(b128$SizeAfter, method="mfv")
mean(b128$Angle)
```


## Purpose
The purpose of this analysis is to evaluate what factors play a major role in the winner of Fat Bear Week. Fat Bear Week is an online single elimination tournament held in Katmai National Park, Alaska. This year it was held from September 29th to October 5th. According to the website, where the voting takes place, who to vote for as the winner is subjective. Some voters may choose to vote based on dramatic change in weight over the year. Other voters might choose to vote based on additional challenges the bears may face in order to gain weight. But in general the idea is to vote for the fattest bear, in the voter's opinion. We hypothesize that the more angled away from the camera the bear is, i.e. the closer the butt of the bear is to the camera, the more votes that bear will receive. We also hypothesize that the probability that a bear will win the second round increases as the number of votes that bear obtains in the first round increases. That is, the likelihood of success, where success is that a particular bear wins in the second round, increases as the number of votes the bear won in the first round increases. We will also explore other variables that might play a role in the who named winner of Fat Bear Week; such as, fur color, change in size, and more. 

## Data
We plan to use data about the last two years of the Fat Bear Week competition that we compiled ourselves from various sources (Fat Bear Week Voting Page, Katmai Park publications, Katmai Bearcams Fan Wiki). We will at some point link to our dataset. There are many more bears at Katmai National Park than are featured in the Fat Bear Week competition. Former park ranger Mike Fitz elaborated on the selection of each year’s competitors, saying, “the bears are typically chosen by the park rangers, based on a variety of factors such as their time of arrival at Brooks River. An early summer arrival at the river ensures that the bear is photographed before and after their weight gain. A compelling storyline is also a driving factor when choosing a contestant. The audience loves to see a veteran bear with skill and resilience, like Otis, competing year after year” (https://www.discovermagazine.com/planet-earth/a-glimpse-inside-fat-bear-week). Although the contest began in 2014, we restricted our investigation to the contests that took place in 2020 and 2021. Contests prior to those years took place on Facebook with the bear whose post received the most “Likes” winning each round, where we have no way to control for bias due to its algorithm. In 2020 and 2021, voting took place on a designated webpage (https://explore.org/fat-bear-week) which guarantees that all respondents saw both bears for each match-up they voted in. 

Respondent perception of a bear’s size, color, and position in relation to the camera is subjective and vary between respondents. To determine the attributes size (before & after), color, and angle of each bear relative to the camera, we conducted two brief surveys (one for each contest year) with human respondents. The survey asked respondents to look at the official before and after photos of the bears from the contests, and report each bear’s size, angle in relation to the camera, and fur color. We used convenience sampling of primarily our friends and family. We obtained the results of the survey for each bear by identifying the most frequent response for the questions related to fur color and size, and took the mean of the responses for angle to the camera.

## Population
Each row of the dataset is one half of a matchup in the tournament. Each row contains the bear’s designated number, name (if applicable), contest year, round, opponent’s designated number, number of votes received in that matchup, outcome of the matchup, outcome of the whole tournament, number of previous Fat Bear Week wins, sex, age, fur color, summer size (before), fall size(after), and angle to the camera. It is our hope that our findings could be applied to predicting the winner of future Fat Bear Week tournaments.

## Outcome Variable
The outcome variable for the first hypothesis is Winning Round 2. It's a binary response with 0 represnting a loss and 1 representing a win.
The outcome variable for the second hypothesis is number of votes obtained in the first round. This is a quantitative variable in the positive integers, each vote will count as one unit.

## Explanatory Variable
The explanatory variables are:
Sex, a binary variable with values "M" for male and "F" for female.
Color is a categorical variable. It's possible values are "Blond", "Light Brown", "Brown", "dark Brown"
Age is a quantitative variable. Its unit is years.
Presence of names is a binary variable. It will be 0 if the bear does not have a name and 1 when they have a name.
Number of Votes is a quantitative variable, Each one point increase is equivalent to 1 additional vote towards the bear. 


## Exploratory Visualizations
A preliminary exploration of our data shows that there is some relationship between winning a round and some of our predictor variables using simple logistic regression. There appears to be positive associations between angle to camera and the likelihood of winning a round, bear age and likelihood of winning a round, and number of votes and winning a round.
```{r}
bears %>%
  select(RoundWinBinary, Sex, SurveyFur, SurveyBefore, SurveyAfter, SurveyAngle) %>%
  ggpairs()

plot <- qplot(x = SurveyAngle, y = RoundWinBinary, data = bears,
              alpha = 0.2, show.legend = FALSE,
              geom = "jitter", height = 0.02, width = 0)
plot + geom_smooth(method = "glm",
method.args = list(family = "binomial"), se = 0)
```

```{r}
qplot(x=ParkAge, y=RoundWinBinary, data=bears) + geom_smooth(method="glm", se=FALSE)

qplot(x=Number.of.Votes, y=RoundWinBinary, data=bears) +
  geom_smooth(method="glm", se=FALSE)
```

```{r}
bears %>%
  select(CompWinBinary, Round, ParkAge, SurveyFur, SurveyBefore, SurveyAfter, SurveyAngle) %>%
  ggpairs()
```



